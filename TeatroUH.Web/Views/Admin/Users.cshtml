@model List<TeatroUH.Domain.Entities.User>

@{
    ViewData["Title"] = "Usuarios y Permisos";
    var msg = TempData["MSG"] as string;
}

<div class="p-8">
    <h1 class="text-3xl font-bold text-white">Usuarios y Permisos</h1>
    <p class="text-gray-400 mt-1">Aquí podés asignar o quitar rol Admin.</p>

    @if (!string.IsNullOrWhiteSpace(msg))
    {
        <div class="mt-4 p-3 rounded border border-yellow-700 bg-yellow-900/20 text-yellow-200">
            @msg
        </div>
    }

    <div class="mt-6 overflow-x-auto">
        <table class="min-w-full text-sm text-gray-200 border border-gray-800">
            <thead class="bg-black/40">
                <tr>
                    <th class="p-3 text-left border-b border-gray-800">ID</th>
                    <th class="p-3 text-left border-b border-gray-800">Nombre</th>
                    <th class="p-3 text-left border-b border-gray-800">Email</th>
                    <th class="p-3 text-left border-b border-gray-800">Rol</th>
                    <th class="p-3 text-left border-b border-gray-800">Acciones</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var u in Model)
                {
                    <tr class="border-b border-gray-900">
                        <td class="p-3">@u.Id</td>
                        <td class="p-3">@u.Nombre</td>
                        <td class="p-3">@u.Email</td>
                        <td class="p-3">
                            <span class="px-2 py-1 rounded bg-black/30 border border-gray-700">
                                @u.Role
                            </span>
                        </td>
                        <td class="p-3 flex gap-2">

                            @if (u.Role.ToString() != "Admin")
                            {
                                <form asp-action="MakeAdmin" method="post">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@u.Id" />
                                    <button class="px-3 py-1 rounded bg-[#B89B5E] text-black font-bold">
                                        Hacer Admin
                                    </button>
                                </form>
                            }
                            else
                            {
                                <form asp-action="RemoveAdmin" method="post">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@u.Id" />
                                    <button class="px-3 py-1 rounded bg-red-600 text-white font-bold">
                                        Quitar Admin
                                    </button>
                                </form>
                            }

                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="mt-6">
        <a asp-controller="Admin" asp-action="Index"
           class="inline-block px-4 py-2 rounded bg-black/30 border border-gray-700 text-gray-200">
            Volver
        </a>
    </div>
</div>
